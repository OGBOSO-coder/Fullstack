(()=>{"use strict";var e,r,o={7321:function(e,r,o){var t=this&&this.__awaiter||function(e,r,o,t){return new(o||(o=Promise))((function(i,n){function s(e){try{d(t.next(e))}catch(e){n(e)}}function a(e){try{d(t.throw(e))}catch(e){n(e)}}function d(e){var r;e.done?i(e.value):(r=e.value,r instanceof o?r:new o((function(e){e(r)}))).then(s,a)}d((t=t.apply(e,r||[])).next())}))};Object.defineProperty(r,"__esModule",{value:!0}),r.deactivate=r.activate=void 0;const i=o(1017),n=(o(4892),o(9496)),s=o(4794),a=o(3273),d=o(7913),c=o(1043),l=o(8713),u=o(7026),p=o(6651),g=o(9506),v=o(215),f=o(9179),m=o(7526),x=o(4172),y=o(1945),h=o(4695),w=o(8332);let q;function C(e,r){throw e instanceof f.EmptyLangsResponseError&&w.Logger.error("The above error may have been caused by an interfering antivirus program. Please add an exception for the following folder:",r),e}r.activate=function(e){return t(this,void 0,void 0,(function*(){try{yield function(e){var r;return t(this,void 0,void 0,(function*(){const o=null===(r=n.extensions.getExtension(p.EXTENSION_ID))||void 0===r?void 0:r.packageJSON.version;w.Logger.configure(w.LogLevel.Verbose),w.Logger.info(`Starting ${p.EXTENSION_ID} in "${p.DEBUG_MODE?"development":"production"}" mode.`),w.Logger.info(`${n.env.appName} version: ${n.version}`),w.Logger.info(`${p.EXTENSION_ID} version: ${o}`),w.Logger.info(`Currently open workspace: ${n.workspace.name}`);const b=new a.default,L=i.join(e.globalStorageUri.fsPath,"cli"),E=yield m.downloadCorrectLangsVersion(L,b);E.err&&C(E.val,L);const I=new l.default(E.val,p.CLIENT_NAME,o,{cliConfigDir:p.TMC_LANGS_CONFIG_DIR}),_=yield I.isAuthenticated({timeout:15e3});_.err&&(w.Logger.error("Failed to check if authenticated:",_.val.message),C(_.val,L));const O=_.val;yield n.commands.executeCommand("setContext","test-my-code:LoggedIn",O);const S=new c.default(e),k=yield(0,x.migrateExtensionDataFromPreviousVersions)(e,S,b,I,n.workspace.getConfiguration());if(k.err){if(k.val instanceof f.HaltForReloadError)return void w.Logger.warn("Extension expected to restart");C(k.val,L)}const P=yield I.getSetting("projects-dir",(e=>"string"==typeof e));P.err?(w.Logger.error("Failed to define datapath:",P.val),C(P.val,L)):void 0===P.val&&(w.Logger.error("Failed to define datapath: no value found."),C(new Error("No value for datapath."),L));const N=P.val,D=i.join(e.globalStorageUri.fsPath,"workspaces"),F=yield m.resourceInitialization(e,S,N,D);F.err&&(w.Logger.error("Resource initialization failed: ",F.val),C(F.val,L));const T=F.val,j=new g.default(S);e.subscriptions.push(j),w.Logger.configure(j.getLogLevel());const V=new h.default(e,T),M={loggedIn:V.treeDP.createVisibilityGroup(O)};I.on("login",(()=>t(this,void 0,void 0,(function*(){yield n.commands.executeCommand("setContext","test-my-code:LoggedIn",!0),V.treeDP.updateVisibility([M.loggedIn])})))),I.on("logout",(()=>t(this,void 0,void 0,(function*(){b.warningNotification("Your TMC session has expired, please log in."),yield n.commands.executeCommand("setContext","test-my-code:LoggedIn",!1),V.treeDP.updateVisibility([M.loggedIn.not]),V.webview.setContentFromTemplate({templateName:"login"})}))));const $=T.extensionVersion,A=S.getSessionState(),U=null==A?void 0:A.extensionVersion;$!==U&&S.updateSessionState({extensionVersion:$});const R=new v.UserData(S),z=new u.default(T);e.subscriptions.push(z),z.activeCourse&&(yield n.commands.executeCommand("setContext","test-my-code:WorkspaceActive",!0),yield z.verifyWorkspaceSettingsIntegrity());const G=new y.default(T,V),W=new d.default(R,z),X={dialog:b,exerciseDecorationProvider:W,resources:T,settings:j,temporaryWebviewProvider:G,tmc:I,ui:V,userData:R,workspaceManager:z,visibilityGroups:M},H=yield(0,s.refreshLocalExercises)(X);H.err&&w.Logger.warn("Failed to set initial exercises.",H.val),m.registerUiActions(X),m.registerCommands(e,X),m.registerSettingsCallbacks(X),e.subscriptions.push(n.window.registerFileDecorationProvider(W)),O&&(n.commands.executeCommand("tmc.updateExercises","silent"),(0,s.checkForCourseUpdates)(X)),q&&clearInterval(q),q=setInterval((()=>t(this,void 0,void 0,(function*(){const e=yield I.isAuthenticated();e.err?w.Logger.error("Failed to check if authenticated",e.val.message):e.val&&(n.commands.executeCommand("tmc.updateExercises","silent"),(0,s.checkForCourseUpdates)(X)),yield n.commands.executeCommand("setContext","test-my-code:LoggedIn",e.val)}))),p.EXERCISE_CHECK_INTERVAL);const B=(0,w.semVerCompare)($,U||"","minor");(void 0===B||B>0)&&(yield n.commands.executeCommand("tmc.showWelcome"))}))}(e)}catch(e){w.Logger.error(`Error during initialization: ${e}`),n.window.showErrorMessage(`TestMyCode initialization failed: ${e}`),w.Logger.show()}}))},r.deactivate=function(){q&&clearInterval(q)}},9496:e=>{e.exports=require("vscode")},9491:e=>{e.exports=require("assert")},852:e=>{e.exports=require("async_hooks")},4300:e=>{e.exports=require("buffer")},2081:e=>{e.exports=require("child_process")},6206:e=>{e.exports=require("console")},2057:e=>{e.exports=require("constants")},6113:e=>{e.exports=require("crypto")},7643:e=>{e.exports=require("diagnostics_channel")},2361:e=>{e.exports=require("events")},7147:e=>{e.exports=require("fs")},3685:e=>{e.exports=require("http")},1808:e=>{e.exports=require("net")},7561:e=>{e.exports=require("node:fs")},9411:e=>{e.exports=require("node:path")},7742:e=>{e.exports=require("node:process")},4492:e=>{e.exports=require("node:stream")},3020:e=>{e.exports=require("node:url")},7261:e=>{e.exports=require("node:util")},2037:e=>{e.exports=require("os")},1017:e=>{e.exports=require("path")},4074:e=>{e.exports=require("perf_hooks")},3477:e=>{e.exports=require("querystring")},2781:e=>{e.exports=require("stream")},5356:e=>{e.exports=require("stream/web")},1576:e=>{e.exports=require("string_decoder")},4404:e=>{e.exports=require("tls")},7310:e=>{e.exports=require("url")},3837:e=>{e.exports=require("util")},9830:e=>{e.exports=require("util/types")},1267:e=>{e.exports=require("worker_threads")},9796:e=>{e.exports=require("zlib")}},t={};function i(e){var r=t[e];if(void 0!==r)return r.exports;var n=t[e]={id:e,loaded:!1,exports:{}};return o[e].call(n.exports,n,n.exports,i),n.loaded=!0,n.exports}i.m=o,i.x=()=>{var e=i.O(void 0,[647],(()=>i(7321)));return e=i.O(e)},e=[],i.O=(r,o,t,n)=>{if(!o){var s=1/0;for(l=0;l<e.length;l++){for(var[o,t,n]=e[l],a=!0,d=0;d<o.length;d++)(!1&n||s>=n)&&Object.keys(i.O).every((e=>i.O[e](o[d])))?o.splice(d--,1):(a=!1,n<s&&(s=n));if(a){e.splice(l--,1);var c=t();void 0!==c&&(r=c)}}return r}n=n||0;for(var l=e.length;l>0&&e[l-1][2]>n;l--)e[l]=e[l-1];e[l]=[o,t,n]},i.d=(e,r)=>{for(var o in r)i.o(r,o)&&!i.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:r[o]})},i.f={},i.e=e=>Promise.all(Object.keys(i.f).reduce(((r,o)=>(i.f[o](e,r),r)),[])),i.u=e=>"lib.js",i.o=(e,r)=>Object.prototype.hasOwnProperty.call(e,r),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{var e={898:1};i.O.require=r=>e[r];i.f.require=(r,o)=>{e[r]||(r=>{var o=r.modules,t=r.ids,n=r.runtime;for(var s in o)i.o(o,s)&&(i.m[s]=o[s]);n&&n(i);for(var a=0;a<t.length;a++)e[t[a]]=1;i.O()})(require("./"+i.u(r)))}})(),r=i.x,i.x=()=>(i.e(647),r());var n=i.x();module.exports=n})();